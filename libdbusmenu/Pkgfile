# Description: Library for passing menus over DBus (GTK+ 2 library)
# URL: https://launchpad.net/libdbusmenu
# Maintainer: Tim Biermann, tbier at posteo dot de
# Depends on: gtk gtk3 gnome-common gobject-introspection vala

name=libdbusmenu
version=16.04.0
release=1
source=(https://launchpad.net/libdbusmenu/${version%.?}/$version/+download/libdbusmenu-$version.tar.gz)

build() {
  cd libdbusmenu-$version
  export HAVE_VALGRIND_TRUE='#'
  export HAVE_VALGRIND_FALSE=''
  mkdir -p build{-gtk2,-gtk3}
  cd build-gtk3
  ../configure --prefix=/usr \
    --sysconfdir=/etc \
    --localstatedir=/var \
    --disable-{dumper,static,tests} \
    --with-gtk=3
  make
  make -j1 -C libdbusmenu-glib DESTDIR=$PKG install
  make -j1 -C libdbusmenu-gtk DESTDIR=$PKG install
  ../configure --prefix=/usr \
    --sysconfdir=/etc \
    --localstatedir=/var \
    --disable-{dumper,static,tests} \
    --with-gtk=2
  make
  make -j1 -C libdbusmenu-glib DESTDIR=$PKG install
  make -j1 -C libdbusmenu-gtk DESTDIR=$PKG install
}
