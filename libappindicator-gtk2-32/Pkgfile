# Description:
# URL:
# Maintainer:
# Depends on: libdbusmenu-gtk2-32

name=libappindicator-gtk2
version=12.10.0
release=1
source=(http://launchpad.net/libappindicator/${version%.*}/$version/+download/libappindicator-$version.tar.gz incompatible_pointer_build_fix.patch no-python.patch)

build() {
  cd libappindicator-$version
  patch -p1 -i ../incompatible_pointer_build_fix.patch
  patch -p1 -i ../no-python.patch
  sed 's|/cli/|/mono/|' -i bindings/mono/{appindicator-sharp-0.1.pc.in,Makefile.in}
  sed 's/example //g' -i Makefile.in
  export CFLAGS="${CFLAGS} -Wno-deprecated-declarations"
  export CSC='/usr/bin/mcs'
  export CC='gcc -m32'
  export CXX='g++ -m32'
  export PKG_CONFIG_PATH='/usr/lib32/pkgconfig'
  ./configure --prefix=/usr \
      --localstatedir=/var \
      --disable-{gtk-doc-html,mono-test,static,test} \
      --with-gtk=2
  make
  make DESTDIR=$PKG -j1 install
  rm -r $PKG/usr/share/gtk-doc
}
