# Description: Wayland is intended as a simpler replacement for X
# URL: https://wayland.freedesktop.org/
# Maintainer: Tim Biermann, tbier at posteo dot de
# Depends on: libffi-32 libxml2-32 wayland

name=wayland-32
version=1.17.0
release=1
source=(https://wayland.freedesktop.org/releases/${name::7}-$version.tar.xz)

build() {
  cd ${name::7}-$version
  export CC='gcc -m32'
  export PKG_CONFIG_PATH=/usr/lib32/pkgconfig
  ./configure \
    --prefix=/usr \
    --libdir=/usr/lib32 \
    --disable-static \
    --disable-documentation
  sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool
  make
  make DESTDIR=$PKG install
  rm -fr $PKG/usr/{bin,include,share}
}
